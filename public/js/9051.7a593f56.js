"use strict";(self["webpackChunkiHRIS_v5"]=self["webpackChunkiHRIS_v5"]||[]).push([[9051],{2245:function(){},3702:function(e,t,a){a.d(t,{Z:function(){return n}});a(2245);var i=a(172),s=a(8230),r=a(7764),n=r.Z.extend({name:"v-checkbox",props:{indeterminate:Boolean,indeterminateIcon:{type:String,default:"$checkboxIndeterminate"},offIcon:{type:String,default:"$checkboxOff"},onIcon:{type:String,default:"$checkboxOn"}},data(){return{inputIndeterminate:this.indeterminate}},computed:{classes(){return{...s.Z.options.computed.classes.call(this),"v-input--selection-controls":!0,"v-input--checkbox":!0,"v-input--indeterminate":this.inputIndeterminate}},computedIcon(){return this.inputIndeterminate?this.indeterminateIcon:this.isActive?this.onIcon:this.offIcon},validationState(){if(!this.isDisabled||this.inputIndeterminate)return this.hasError&&this.shouldValidate?"error":this.hasSuccess?"success":null!==this.hasColor?this.computedColor:void 0}},watch:{indeterminate(e){this.$nextTick((()=>this.inputIndeterminate=e))},inputIndeterminate(e){this.$emit("update:indeterminate",e)},isActive(){this.indeterminate&&(this.inputIndeterminate=!1)}},methods:{genCheckbox(){const{title:e,...t}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(i.Z,this.setTextColor(this.validationState,{props:{dense:this.dense,dark:this.dark,light:this.light}}),this.computedIcon),this.genInput("checkbox",{...t,"aria-checked":this.inputIndeterminate?"mixed":this.isActive.toString()}),this.genRipple(this.setTextColor(this.rippleState))])},genDefaultSlot(){return[this.genCheckbox(),this.genLabel()]}}})},3205:function(e,t,a){a.d(t,{Z:function(){return r}});var i=a(8085),s=a(3325),r=(0,s.Z)(i.Z).extend({name:"v-subheader",props:{inset:Boolean},render(e){return e("div",{staticClass:"v-subheader",class:{"v-subheader--inset":this.inset,...this.themeClasses},attrs:this.$attrs,on:this.$listeners},this.$slots.default)}})},9155:function(e,t,a){var i=a(6286),s=a(538);t["Z"]=s["default"].extend({name:"rippleable",directives:{ripple:i.Z},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple(e={}){return this.ripple?(e.staticClass="v-input--selection-controls__ripple",e.directives=e.directives||[],e.directives.push({name:"ripple",value:{center:!0}}),this.$createElement("div",e)):null}}})},7764:function(e,t,a){a.d(t,{X:function(){return l}});var i=a(8230),s=a(9155),r=a(4419),n=a(3325);function l(e){e.preventDefault()}t["Z"]=(0,n.Z)(i.Z,s.Z,r.Z).extend({name:"selectable",model:{prop:"inputValue",event:"change"},props:{id:String,inputValue:null,falseValue:null,trueValue:null,multiple:{type:Boolean,default:null},label:String},data(){return{hasColor:this.inputValue,lazyValue:this.inputValue}},computed:{computedColor(){if(this.isActive)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},isMultiple(){return!0===this.multiple||null===this.multiple&&Array.isArray(this.internalValue)},isActive(){const e=this.value,t=this.internalValue;return this.isMultiple?!!Array.isArray(t)&&t.some((t=>this.valueComparator(t,e))):void 0===this.trueValue||void 0===this.falseValue?e?this.valueComparator(e,t):Boolean(t):this.valueComparator(t,this.trueValue)},isDirty(){return this.isActive},rippleState(){return this.isDisabled||this.validationState?this.validationState:void 0}},watch:{inputValue(e){this.lazyValue=e,this.hasColor=e}},methods:{genLabel(){const e=i.Z.options.methods.genLabel.call(this);return e?(e.data.on={click:l},e):e},genInput(e,t){return this.$createElement("input",{attrs:Object.assign({"aria-checked":this.isActive.toString(),disabled:this.isDisabled,id:this.computedId,role:e,type:e},t),domProps:{value:this.value,checked:this.isActive},on:{blur:this.onBlur,change:this.onChange,focus:this.onFocus,keydown:this.onKeydown,click:l},ref:"input"})},onClick(e){this.onChange(),this.$emit("click",e)},onChange(){if(!this.isInteractive)return;const e=this.value;let t=this.internalValue;if(this.isMultiple){Array.isArray(t)||(t=[]);const a=t.length;t=t.filter((t=>!this.valueComparator(t,e))),t.length===a&&t.push(e)}else t=void 0!==this.trueValue&&void 0!==this.falseValue?this.valueComparator(t,this.trueValue)?this.falseValue:this.trueValue:e?this.valueComparator(t,e)?null:e:!t;this.validate(!0,t),this.internalValue=t,this.hasColor=t},onFocus(e){this.isFocused=!0,this.$emit("focus",e)},onBlur(e){this.isFocused=!1,this.$emit("blur",e)},onKeydown(e){}}})},9631:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"grid-list-xs":""}},[a("v-overlay",{attrs:{value:e.overlay}},[a("v-progress-circular",{attrs:{color:"primary",indeterminate:"",size:"50"}}),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.overlay=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("v-overlay",{attrs:{value:e.overlayUnclosed}},[a("v-progress-circular",{attrs:{color:"primary",indeterminate:"",size:"50"}})],1),a("v-dialog",{attrs:{transition:"dialog-top-transition","max-width":"600"},model:{value:e.leaveRequestDialog,callback:function(t){e.leaveRequestDialog=t},expression:"leaveRequestDialog"}},[a("v-card",[a("v-toolbar",{attrs:{color:"primary",dark:""}},[e._v("About to send leave request")]),a("v-card-text",[e._v(" Are you sure that you want to request "+e._s(this.days)+" Days starting "+e._s(this.$moment(this.startDate).format("DD-MM-YYYY"))+" and ending "+e._s(this.$moment(this.endDate).format("DD-MM-YYYY"))+"? ")]),a("v-card-actions",{staticClass:"justify-end"},[a("v-btn",{attrs:{color:"error"},on:{click:function(t){e.leaveRequestDialog=!1}}},[e._v("Cancel")]),a("v-spacer"),a("v-btn",{on:{click:e.createLeaveRequest}},[e._v("Yes, Proceed")])],1)],1)],1),a("v-navigation-drawer",{staticClass:"primary darken-1 white--text",staticStyle:{"z-index":"3"},attrs:{app:"",clipped:"",permanent:"",right:""}},[a("v-list",{staticClass:"white--text"},[a("v-list-item",[a("v-btn",{staticClass:"secondary",attrs:{dark:""},on:{click:function(t){return e.$router.push("/resource/view/practitioner/"+e.queries.practitioner)}}},[a("v-icon",{attrs:{light:"",left:""}},[e._v("mdi-eye")]),a("span",[e._v("View Health Profession")])],1)],1)],1)],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.leaveDetailsHeaders,items:e.leaveDetails,"items-per-page":10}}),a("v-card",[a("v-card-title",{attrs:{"primary-title":""}},[e._v(" Select Category* ")]),a("v-card-text",[a("v-row",{attrs:{"no-gutters":""}},e._l(e.leaveCategories,(function(t){return a("v-col",{key:t.value,attrs:{cols:"3"}},[a("v-checkbox",{attrs:{label:t.text,value:t.value,disabled:e.disabledCategory[t.value]},on:{change:e.checkCategorySelection},model:{value:e.selectedCategories,callback:function(t){e.selectedCategories=t},expression:"selectedCategories"}})],1)})),1),e.invalidDates?a("div",{staticStyle:{color:"red"}},[e._v(" Start Date must be before end date"),a("br")]):e._e(),a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-text-field",e._g({attrs:{label:"Start Date*","prepend-inner-icon":"mdi-calendar",readonly:"",outlined:"","hide-details":"auto",dense:""},on:{input:function(t){e.days=0}},model:{value:e.startDateFormatted,callback:function(t){e.startDateFormatted=t},expression:"startDateFormatted"}},i))]}}]),model:{value:e.startDateMenu,callback:function(t){e.startDateMenu=t},expression:"startDateMenu"}},[a("v-date-picker",{on:{change:function(t){e.startDateFormatted=e.formatDate(e.startDate)},input:function(t){e.startDateMenu=!1}},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1)],1),a("v-col",{attrs:{cols:"6"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-text-field",e._g({attrs:{label:"End Date*","prepend-inner-icon":"mdi-calendar",readonly:"",outlined:"","hide-details":"auto",dense:""},on:{input:function(t){e.days=0}},model:{value:e.endDateFormatted,callback:function(t){e.endDateFormatted=t},expression:"endDateFormatted"}},i))]}}]),model:{value:e.endDateMenu,callback:function(t){e.endDateMenu=t},expression:"endDateMenu"}},[a("v-date-picker",{on:{change:function(t){e.endDateFormatted=e.formatDate(e.endDate)},input:function(t){e.endDateMenu=!1}},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1),a("v-col",{attrs:{cols:"6"}},[e.requiresSupportingDoc?a("fhir-attachment",{attrs:{field:"value[x]:valueAttachment",label:"Supporting Document",min:"1",max:"1",path:"attachment",slotProps:{source:{path:".extension:attachment",data:[]}},edit:!0}}):e._e()],1),this.days||0===this.days?a("v-col",{attrs:{cols:"12"}},[a("b",[e._v("This will give you "),[e._v(e._s(e.days))],e._v(" Days of leave")],2),a("br"),this.balanceDays<this.days?a("div",{staticStyle:{color:"red"}},[e._v(" You are requesting more days than the balance you have, adjust the end date ")]):e._e()]):e._e()],1)],1)],1),a("v-card-actions",[a("v-btn",{attrs:{color:"success",disabled:!e.canSubmitLeave},on:{click:e.displayRequestDialog}},[e._v("Submit Request")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",disabled:!e.canGoNext},on:{click:e.getDays}},[e._v("Check")])],1),a("br"),a("br")],1)],1)},s=[],r=(a(6699),{props:["queries"],data(){return{valid:!0,overlay:!1,overlayUnclosed:!1,loading:!1,leaveRequestDialog:!1,leaveDetails:[],leaveCategories:[],selectedCategories:[],disabledCategory:{},startDateMenu:!1,endDateMenu:!1,startDateFormatted:"",endDateFormatted:"",startDate:"",endDate:"",days:"",balanceDays:"",errors:{days:[]},leaveDetailsHeaders:[{text:"Period",value:"period"},{text:"Category",value:"category"},{text:"Leave Days",value:"maxDays"},{text:"Accrued",value:"accrued"},{text:"Days on Leave",value:"daysOnLeave"},{text:"Expired",value:"expired"},{text:"Balance",value:"balance"}]}},watch:{endDateFormatted(){this.days=""},startDateFormatted(){this.days=""}},computed:{requiresSupportingDoc(){return!!(this.selectedCategories.includes("study")||this.selectedCategories.includes("sick")||this.selectedCategories.includes("sickhalfpay")||this.selectedCategories.includes("specialsick")||this.selectedCategories.includes("maternity"))},canGoNext(){return!(!(this.selectedCategories.length&&this.startDate&&this.endDate)||this.invalidDates)},canSubmitLeave(){return!(!this.days||!(this.days<=this.balanceDays||"N/A"===this.balanceDays))},invalidDates(){return!!(this.startDate&&this.endDate&&this.$moment(this.startDate).isAfter(this.endDate))},daysrule(){return[e=>(this.errors.days=[],e?!!Number.isInteger(e)||(this.errors.days=["Days must be a number"],"Days must be a number"):(this.errors.days=["Days is required"],"Days is required"))]}},methods:{displayRequestDialog(){this.$refs.form.validate(),this.valid&&(this.leaveRequestDialog=!0)},formatDate(e){return e?this.$moment(e).format("DD-MM-YYYY"):null},getDays(){let e=this.leaveDetails.find((e=>this.selectedCategories.includes(e.categoryid)));this.balanceDays=e.balance,fetch("/site/leave/getDays/"+this.startDate+"/"+this.endDate).then((e=>e.json().then((async e=>{this.days=e}))))},checkCategorySelection(){if(this.disabledCategory={},0!==this.selectedCategories.length)for(let e of this.leaveCategories)this.selectedCategories.includes(e.value)||this.$set(this.disabledCategory,e.value,!0)},getLeaveCategories(){fetch("/fhir/Basic?_profile=http://ihris.org/fhir/StructureDefinition/na-leave-category-profile&_count=200").then((e=>e.json().then((async e=>{if(e&&e.entry&&e.entry.length)for(let t of e.entry){let e=t.resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/ihris-basic-name"===e.url)).valueString;this.leaveCategories.push({text:e,value:t.resource.id})}}))))},getLeaveBalance(){this.overlayUnclosed=!0,fetch("/site/leave/balance/"+this.queries.practitioner).then((e=>e.json().then((e=>{this.leaveDetails=e,this.overlayUnclosed=!1}))))},createLeaveRequest(){this.overlayUnclosed=!0;let e=[];this.populateValues(this.$children,e);let t=e.find((e=>"attachment"===e.path)),a={startDate:this.startDate,endDate:this.endDate,leaveCategory:this.selectedCategories};t&&(a.attachment=t.value),fetch("/site/leave/createLeaveRequest/"+this.queries.practitioner,{method:"POST",headers:{"Content-Type":"application/json"},redirect:"manual",body:JSON.stringify(a)}).then((e=>{this.overlayUnclosed=!1,this.leaveRequestDialog=!1,201===e.status?(this.$store.commit("setMessage",{type:"success",text:"Leave Request Created Successfully"}),e.json().then((e=>{this.$router.push("/custom/leave-request-view?path=/namibia/components&id="+e.id)}))):e.json().then((e=>{this.$store.commit("setMessage",{type:"error",text:e.message})}))})).catch((()=>{this.overlayUnclosed=!1,this.$store.commit("setMessage",{type:"error",text:"Failed To Create Carry Forward Request."})}))},populateValues(e,t){for(let a of e)a.qField&&a.value&&a.path&&t.push({qField:a.qField,path:a.path,value:a.value}),a.$children&&this.populateValues(a.$children,t)}},components:{"fhir-attachment":()=>Promise.all([a.e(7028),a.e(7833)]).then(a.bind(a,7028))},created(){this.getLeaveBalance(),this.getLeaveCategories()}}),n=r,l=a(3736),o=a(3453),c=a.n(o),u=a(3150),d=a(2371),h=a(7118),v=a(3702),p=a(2102),m=a(4228),y=a(865),f=a(9771),g=a(4497),D=a(6232),b=a(6428),C=a(6816),x=a(7620),k=a(1152),V=a(5132),S=a(1058),_=a(624),Z=a(2877),$=a(9762),q=a(5978),I=a(6656),w=(0,l.Z)(n,i,s,!1,null,null,null),F=w.exports;c()(w,{VBtn:u.Z,VCard:d.Z,VCardActions:h.h7,VCardText:h.ZB,VCardTitle:h.EB,VCheckbox:v.Z,VCol:p.Z,VContainer:m.Z,VDataTable:y.Z,VDatePicker:f.Z,VDialog:g.Z,VForm:D.Z,VIcon:b.Z,VList:C.Z,VListItem:x.Z,VMenu:k.Z,VNavigationDrawer:V.Z,VOverlay:S.Z,VProgressCircular:_.Z,VRow:Z.Z,VSpacer:$.Z,VTextField:q.Z,VToolbar:I.Z})}}]);
//# sourceMappingURL=9051.7a593f56.js.map